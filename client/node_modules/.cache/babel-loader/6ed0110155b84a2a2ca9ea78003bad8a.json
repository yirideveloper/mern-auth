{"ast":null,"code":"import _regeneratorRuntime from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/flav/Projects/Update/mern-authentification/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/flav/Projects/Update/mern-authentification/client/src/components/pages/Login/Login.jsx\";\nimport Joi from 'joi-browser';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Link, Redirect } from 'react-router-dom';\nimport { attemptLogin as _attemptLogin } from '../../../store/thunks/auth';\nimport Form from '../../common/form/form.jsx';\nimport styles from './Login.module.css';\n\nvar LoginForm =\n/*#__PURE__*/\nfunction (_Form) {\n  _inherits(LoginForm, _Form);\n\n  function LoginForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LoginForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LoginForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      data: {\n        username: '',\n        password: ''\n      },\n      errors: {}\n    };\n    _this.schema = {\n      username: Joi.string().label('Username').required(),\n      password: Joi.string().label('Password').required()\n    };\n    _this.doSubmit =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              data = _this.state.data;\n              _context.next = 3;\n              return _this.props.attemptLogin(data).catch(function (error) {\n                if (error.response && error.response.status === 400) {\n                  var errors = _objectSpread({}, _this.state.errors);\n\n                  errors.username = error.response.data.message;\n\n                  _this.setState({\n                    errors: errors\n                  });\n                }\n              });\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _this;\n  }\n\n  _createClass(LoginForm, [{\n    key: \"render\",\n    value: function render() {\n      if (this.props.isAuth) return React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36\n        },\n        __self: this\n      }); // ne peut pas se relog si deja log\n\n      return React.createElement(\"div\", {\n        id: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        id: styles.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, \"Log in to your account\"), React.createElement(\"div\", {\n        id: styles.formContainer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"ui large form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42\n        },\n        __self: this\n      }, this.renderInput('username', 'Username', 'text', 'user icon'), this.renderInput('password', 'Password', 'password', 'lock icon'), React.createElement(\"div\", {\n        id: styles.forgotMessage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: \"/login/forgot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46\n        },\n        __self: this\n      }, \"Forgot your password?\")), this.renderButton('Login', styles.loginBtn)), React.createElement(\"h4\", {\n        className: \"ui horizontal divider\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      }, \"Or\"), React.createElement(\"button\", {\n        className: \"ui big button teal\",\n        id: styles.subscribe,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"signup icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }), React.createElement(Link, {\n        to: \"/register\",\n        id: styles.link,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      }, \"Sign Up\"))));\n    }\n  }]);\n\n  return LoginForm;\n}(Form);\n\nfunction mapStateToProps(_ref2) {\n  var user = _ref2.user;\n  return {\n    isAuth: user.isAuth\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    attemptLogin: function attemptLogin(user) {\n      return dispatch(_attemptLogin(user));\n    }\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginForm);","map":{"version":3,"sources":["/home/flav/Projects/Update/mern-authentification/client/src/components/pages/Login/Login.jsx"],"names":["Joi","React","connect","Link","Redirect","attemptLogin","Form","styles","LoginForm","state","data","username","password","errors","schema","string","label","required","doSubmit","props","catch","error","response","status","message","setState","isAuth","container","title","formContainer","handleSubmit","renderInput","forgotMessage","renderButton","loginBtn","subscribe","link","mapStateToProps","user","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import Joi from 'joi-browser';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Link, Redirect } from 'react-router-dom';\nimport { attemptLogin } from '../../../store/thunks/auth';\nimport Form from '../../common/form/form.jsx';\nimport styles from './Login.module.css';\n\nclass LoginForm extends Form {\n  state = {\n    data: { username: '', password: '' },\n    errors: {}\n  };\n\n  schema = {\n    username: Joi.string()\n      .label('Username')\n      .required(),\n    password: Joi.string()\n      .label('Password')\n      .required()\n  };\n\n  doSubmit = async () => {\n    const { data } = this.state;\n    await this.props.attemptLogin(data).catch(error => {\n      if (error.response && error.response.status === 400) {\n        const errors = { ...this.state.errors };\n        errors.username = error.response.data.message;\n        this.setState({ errors });\n      }\n    });\n  };\n\n  render() {\n    if (this.props.isAuth) return <Redirect to=\"/home\" />; // ne peut pas se relog si deja log\n\n    return (\n      <div id={styles.container}>\n        <p id={styles.title}>Log in to your account</p>\n        <div id={styles.formContainer}>\n          <form onSubmit={this.handleSubmit} className=\"ui large form\">\n            {this.renderInput('username', 'Username', 'text', 'user icon')}\n            {this.renderInput('password', 'Password', 'password', 'lock icon')}\n            <div id={styles.forgotMessage}>\n              <Link to=\"/login/forgot\">Forgot your password?</Link>\n            </div>\n            {this.renderButton('Login', styles.loginBtn)}\n          </form>\n          <h4 className=\"ui horizontal divider\">Or</h4>\n          <button className=\"ui big button teal\" id={styles.subscribe}>\n            <i className=\"signup icon\" />\n            <Link to=\"/register\" id={styles.link}>\n              Sign Up\n            </Link>\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ user }) {\n  return {\n    isAuth: user.isAuth\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    attemptLogin: user => dispatch(attemptLogin(user))\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(LoginForm);\n"]},"metadata":{},"sourceType":"module"}