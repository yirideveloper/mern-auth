(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,n){},108:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(51),c=n.n(o),i=n(13),s=n(5),u=n(6),l=n(8),m=n(7),h=n(9),p=n(3),f=n(113),d=n(55),v=n(110),b=n(10),g=n(21),E=n.n(g);E.a.defaults.baseURL=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,E.a.defaults.withCredentials=!0,E.a.interceptors.response.use(null,function(e){return Promise.reject(e)});var O={get:E.a.get,post:E.a.post,put:E.a.put,delete:E.a.delete},j=function(e){return O.post("/auth/login",e)},w=function(e){return O.post("auth/login/forgot",{email:e})},y=function(e,t){return O.post("auth/login/reset/".concat(t),{password:e})},k="LOGIN_USER",S="LOGOUT_USER",A="UPDATE_USER";var x=function(){return function(e){return O.get("/user").then(function(t){var n;return e((n=t.data.user,{type:A,user:n})),t.data.user})}},C=n(2),N=n.n(C),R=n(12),P=function(e){return function(){var t=Object(R.a)(N.a.mark(function t(n){return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j(e).then(function(e){var t;return n((t=e.data.user,{type:k,user:t})),n(Object(b.push)("/home")),e.data});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},U=function(e){return function(){var t=Object(R.a)(N.a.mark(function t(n){return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e).catch(n(Object(b.push)("/login/forgot")));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},I=function(e,t){return function(){var n=Object(R.a)(N.a.mark(function n(a){return N.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y(e,t).then(function(){a(Object(b.push)("/login"))}).catch(a(Object(b.push)("/login/reset/".concat(t))));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},L=function(){return function(e){return O.post("/auth/logout").then(function(t){return e({type:S}),e(Object(b.push)("/login")),t.data})}},_=function(e){return function(t){return function(e){return O.get("/auth/confirmation/".concat(e))}(e).then(function(){return t(Object(b.push)("/login"))}).catch(t(Object(b.push)("/register")))}},D=function(e){return function(t){return function(e){return O.post("/auth/resend",{email:e})}(e).catch(t(Object(b.push)("/register")))}},T=function(e){return function(t){return function(e){return O.post("/auth/register/reset",{email:e})}(e)}},B=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onClick=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.match.params.token,e.next=3,n.props.attemptGetConfirmation(t).catch(function(e){return console.log(e)});case 3:case"end":return e.stop()}},e)})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(v.a,{to:"/my-profile"}):r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"Click here to confirm your email"),r.a.createElement("button",{onClick:this.onClick},"Confirmation"))}}]),t}(a.Component);var q=Object(p.connect)(function(e){return{isAuth:e.user.isAuth}},function(e){return{attemptGetConfirmation:function(t){return e(_(t))}}})(B),F=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"Check the github repo :"),r.a.createElement("a",{href:"https://github.com/flaviuse/mern-authentification"},"https://github.com/flaviuse/mern-authentification"))}}]),t}(a.Component),W=Object(p.connect)()(F);var G=Object(p.connect)(function(e){return{user:e.user.user}})(function(e){var t=e.user;return r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"Hey ",r.a.createElement("i",null,t.username),"! Check the github repositorie:"),r.a.createElement("a",{href:"https://github.com/flaviuse/mern-authentification"},"https://github.com/flaviuse/mern-authentification"))}),M=n(111),Y=n(112);var H=Object(Y.a)(Object(p.connect)(function(e){var t=e.user;return{user:t.user,isAuth:t.isAuth}})(function(e){var t=e.user,n=e.isAuth;return r.a.createElement("nav",null,r.a.createElement(M.a,{className:"inactive ",activeClassName:"active",to:"/home"},"Home"),!n&&r.a.createElement("div",null,r.a.createElement(M.a,{className:"inactive",activeClassName:"active",to:"/login"},"Login"),r.a.createElement(M.a,{className:"inactive ",activeClassName:"active",to:"/register"},"Register")),n&&r.a.createElement("div",null,r.a.createElement(M.a,{className:"inactive",activeClassName:" active",to:"/my-profile"},t.username),r.a.createElement(M.a,{className:"item",activeClassName:"item active",to:"/logout"},"Logout")))})),J=n(18),V=n(14),X=n.n(V),K=n(38),Q=n(28),$=n(34),z=function(e){var t=e.name,n=e.label,a=e.error,o=e.icon,c=Object($.a)(e,["name","label","error","icon"]);return r.a.createElement("div",null,r.a.createElement("label",{htmlFor:t},n),r.a.createElement("div",null,r.a.createElement("i",{className:o}),r.a.createElement("input",Object.assign({},c,{name:t,id:t,placeholder:n}))),a&&!a.includes("to be empty")&&r.a.createElement("div",{className:"error"},a))},Z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={data:{},errors:{}},n.validate=function(){var e=X.a.validate(n.state.data,n.schema,{abortEarly:!1}).error;if(!e)return null;var t={},a=!0,r=!1,o=void 0;try{for(var c,i=e.details[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value;t[s.path[0]]=s.message}}catch(u){r=!0,o=u}finally{try{a||null==i.return||i.return()}finally{if(r)throw o}}return t},n.validateProperty=function(e){var t=e.name,a=e.value,r=Object(Q.a)({},t,a),o=Object(Q.a)({},t,n.schema[t]),c=X.a.validate(r,o).error;return c?c.details[0].message:null},n.handleSubmit=function(e){e.preventDefault();var t=n.validate();n.setState({errors:t||{}}),t||n.doSubmit()},n.handleChange=function(e){var t=e.currentTarget,a=Object(J.a)({},n.state.errors),r=n.validateProperty(t);r?a[t.name]=r:delete a[t.name];var o=Object(J.a)({},n.state.data);o[t.name]=t.value,n.setState({data:o,errors:a})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"renderButton",value:function(e){return r.a.createElement("button",{disabled:this.validate()},e)}},{key:"renderInput",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=this.state,o=a.data,c=a.errors;return r.a.createElement(z,{type:n,name:e,value:o[e],label:t,onChange:this.handleChange,error:c[e]})}}]),t}(a.Component),ee=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={data:{username:"",password:""},errors:{}},n.schema={username:X.a.string().label("Username").required(),password:X.a.string().label("Password").required()},n.doSubmit=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data,e.next=3,n.props.attemptLogin(t).catch(function(e){if(e.response&&400===e.response.status){var t=Object(J.a)({},n.state.errors);t.username=e.response.data.message,n.setState({errors:t})}});case 3:case"end":return e.stop()}},e)})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(v.a,{to:"/home"}):r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("username","Username","text"),this.renderInput("password","Password","password"),r.a.createElement("div",null,r.a.createElement(K.a,{to:"/login/forgot"},"Forgot your password?")),this.renderButton("Login")),r.a.createElement("h4",null,"Or"),r.a.createElement(K.a,{to:"/register"},"Sign Up"))}}]),t}(Z);var te=Object(p.connect)(function(e){return{isAuth:e.user.isAuth}},function(e){return{attemptLogin:function(t){return e(P(t))}}})(ee),ne=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={data:{email:""},errors:{},submited:!1},n.schema={email:X.a.string().email({minDomainAtoms:2}).required().label("Email")},n.doSubmit=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data,e.next=3,n.props.attemptSendResetPasswordLink(t.email).then(function(){return n.setState({submited:!0})}).catch(function(e){if(e.response&&400===e.response.status){var t=Object(J.a)({},n.state.errors);t.email=e.response.data.message,n.setState({errors:t})}});case 3:case"end":return e.stop()}},e)})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(v.a,{to:"/home"}):r.a.createElement(r.a.Fragment,null,!this.state.submited&&r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"We will send you a reset link on the following email :"),r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("email","Email","text"),this.renderButton("SEND RESET LINK"))),this.state.submited&&r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"A reset link has been sent."),r.a.createElement("p",null,"An reset link has been sent to :",this.state.data.email,". You have 12 hours to activate your account. It can take up to 15 min to receive our email.")))}}]),t}(Z);var ae=Object(p.connect)(function(e){return{isAuth:e.user.isAuth}},function(e){return{attemptSendResetPasswordLink:function(t){return e(U(t))}}})(ne),re=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={data:{password:""},errors:{}},n.schema={password:X.a.string().min(5).max(255).required()},n.doSubmit=Object(R.a)(N.a.mark(function e(){var t,a,r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data,a=n.props.match.params.token,r=t.password,e.next=5,n.props.attemptResetPassword(r,a).catch(function(e){if(e.response&&400===e.response.status){var t=Object(J.a)({},n.state.errors);t.password=e.response.data.message,n.setState({errors:t})}});case 5:case"end":return e.stop()}},e)})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.isAuth?r.a.createElement(v.a,{to:"/home"}):r.a.createElement("div",{className:"container"},r.a.createElement("p",null,"New password"),r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("password","Password","password"),this.renderButton("RESET PASSWORD")))}}]),t}(Z);var oe=Object(p.connect)(function(e){return{isAuth:e.user.isAuth}},function(e){return{attemptResetPassword:function(t,n){return e(I(t,n))}}})(re),ce=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(L()),this.props.dispatch(Object(b.push)("/home"))}},{key:"render",value:function(){return null}}]),t}(a.Component),ie=Object(p.connect)()(ce),se=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).initialState={data:{email:"",password:"",username:""},errors:{},submited:!1,resend:!1},n.state=n.initialState,n.schema={email:X.a.string().email({minDomainAtoms:2}).required().label("Email"),password:X.a.string().min(5).required().label("Password"),username:X.a.string().required()},n.doSubmit=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data,e.next=3,n.props.attemptRegister(t).then(function(){return n.setState({submited:!0})}).catch(function(e){if(e.response&&400===e.response.status){var t=Object(J.a)({},n.state.errors);e.response.data.message.includes("Email")?t.email=e.response.data.message:t.username=e.response.data.message,n.setState({errors:t})}});case 3:case"end":return e.stop()}},e)})),n.resendEmail=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data.email,e.next=3,n.props.attemptResendConfirmation(t).then(function(){return n.setState({resend:!0})});case 3:case"end":return e.stop()}},e)})),n.reset=Object(R.a)(N.a.mark(function e(){var t;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.data.email,e.next=3,n.props.attemptResetRegister(t).then(function(){return n.setState(n.initialState)});case 3:case"end":return e.stop()}},e)})),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,!this.state.resend&&r.a.createElement(r.a.Fragment,null,!this.state.submited&&r.a.createElement("div",null,r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleSubmit},this.renderInput("username","Username","text"),this.renderInput("email","Email","text"),this.renderInput("password","Password","password"),this.renderButton("Sign Up")))),this.state.submited&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",null,r.a.createElement("p",null,"A verification email has been sent."),r.a.createElement("p",null,"Check you mailbox : ",this.state.data.email,". ",r.a.createElement("br",null)," You have 12 hours to activate your account. It can take up to 15 min to receive our email."),r.a.createElement("button",{onClick:this.resendEmail},"Did not receive the email? Click here to send again."))))),this.state.resend&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",null,"Still not received an email? "),"Try to register again. You may have given the wrong email. ",r.a.createElement("br",null),"If you want to be able to user the same username :",r.a.createElement("br",null),r.a.createElement("button",{onClick:this.reset},"Click here to try again."))))}}]),t}(Z),ue=Object(p.connect)(null,function(e){return{attemptRegister:function(t){return e(function(e){return function(){var t=Object(R.a)(N.a.mark(function t(n){return N.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(a=e,O.post("/auth/register",a)).catch(n(Object(b.push)("/register")));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}var a},t)}));return function(e){return t.apply(this,arguments)}}()}(t))},attemptResendConfirmation:function(t){return e(D(t))},attemptResetRegister:function(t){return e(T(t))}}})(se);var le=Object(p.connect)(function(e){return{isAuth:e.user.isAuth}})(function(e){e.path;var t=e.component,n=e.render,a=e.isAuth,o=Object($.a)(e,["path","component","render","isAuth"]);return r.a.createElement(d.a,Object.assign({},o,{render:function(e){return a?t?r.a.createElement(t,e):n(e):r.a.createElement(v.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}),me=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.attemptGetUser().then(function(){return e.setState({loading:!1})}).catch(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this.props,t=e.store,n=e.history;return!this.state.loading&&r.a.createElement(p.Provider,{store:t},r.a.createElement(b.ConnectedRouter,{history:n},r.a.createElement(r.a.Fragment,null,r.a.createElement(H,null),r.a.createElement(f.a,null,r.a.createElement(d.a,{path:"/home",exact:!0,component:W}),r.a.createElement(le,{path:"/my-profile",exact:!0,component:G}),r.a.createElement(d.a,{path:"/account/confirm/:token",exact:!0,component:q}),r.a.createElement(d.a,{path:"/register",exact:!0,component:ue}),r.a.createElement(d.a,{path:"/login",exact:!0,component:te}),r.a.createElement(d.a,{path:"/login/forgot",exact:!0,component:ae}),r.a.createElement(d.a,{path:"/login/reset/:token",component:oe}),r.a.createElement(le,{path:"/logout",exact:!0,component:ie}),r.a.createElement(v.a,{from:"/",exact:!0,to:"/home"}),r.a.createElement(v.a,{to:"/home"})))))}}]),t}(a.Component),he=Object(p.connect)(null,function(e){return{attemptGetUser:function(){return e(x())}}})(me),pe=n(20),fe=(n(93),n(56)),de=n(57);function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isAuth:!1,user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return{user:t.user,isAuth:!0};case S:return{isAuth:!1};case A:return Object(de.isEmpty)(t.user)?{user:t.user,isAuth:!1}:{user:t.user,isAuth:!0};default:return e}}var be=function(e){return Object(pe.c)({router:Object(b.connectRouter)(e),user:ve})};var ge=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ee(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(107);var Oe=Object(i.a)(),je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||pe.d,a=[Object(b.routerMiddleware)(e),fe.a];return Object(pe.e)(be(e),t,n(pe.a.apply(void 0,a)))}(Oe);c.a.render(r.a.createElement(he,{store:je,history:Oe}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");ge?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ee(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Ee(e)})}}()},58:function(e,t,n){e.exports=n(108)}},[[58,1,2]]]);
//# sourceMappingURL=main.d0c14439.chunk.js.map